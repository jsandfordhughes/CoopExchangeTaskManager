import{d as T,T as N,D as c,o as v,c as E,w as n,e as C,g as w,a as m,t as S,b as s,F as U,h as A,E as R,k as H,u as b,i as Y,G as X,H as Q,O as B,I,J as W,s as ee,Q as te}from"./app-DbCRiGnQ.js";import{_ as oe}from"./AppLayout-BS3_Zvwl.js";import"./img-DNTK9n0h.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ae={key:0},se={class:"font-bold"},ie={key:1},ne={class:"dialog-footer"},le={__name:"TaskModal",props:{allowedStatuses:Object,allowedPriorities:Object},emits:["taskCreated"],setup(t,{expose:o,emit:a}){const e=T(!1),l=T(null),d=T(!1),i=a;o({createTask:p,editTask:u});const r=T(N({}));function u(_){var f;r.value=N(_),d.value=!0,e.value=!0,(f=l.value)==null||f.clearValidate()}function p(){var _;r.value=N({title:"",description:"",due_date:"",status:"",priority:""}),d.value=!1,e.value=!0,(_=l.value)==null||_.clearValidate()}const h={title:[{required:!0,message:"Title is required",trigger:"blur"}],description:[{required:!0,message:"Description is required",trigger:"blur"}],due_date:[{required:!0,message:"Due date is required",trigger:"change"}],status:[{required:!0,message:"Status is required",trigger:"change"}],priority:[{required:!0,message:"Priority is required",trigger:"change"}]};function V(){l.value.validate(_=>{if(!_)return;const f=d.value?route("tasks.update",r.value.id):route("tasks.store"),O=d.value?"put":"post";r.value[O](f,{onSuccess:x=>{e.value=!1,r.value.reset(),d.value=!1,!d.value&&y("newTaskId")&&i("taskCreated",y("newTaskId"))}})})}function y(_){return new URLSearchParams(window.location.search).get(_)}return(_,f)=>{const O=c("el-input"),x=c("el-form-item"),P=c("el-date-picker"),M=c("el-option"),g=c("el-select"),L=c("el-form"),G=c("el-button"),J=c("el-dialog");return v(),E(J,{modelValue:e.value,"onUpdate:modelValue":f[5]||(f[5]=k=>e.value=k),width:"500"},{header:n(()=>[d.value?(v(),C("div",ae,[w(" Edit task "),m("span",se,S(r.value.title),1)])):(v(),C("div",ie,"Create a new task"))]),footer:n(()=>[m("div",ne,[s(G,{loading:r.value.processing,type:"primary",onClick:V},{default:n(()=>[w(S(d.value?"Update":"Create"),1)]),_:1},8,["loading"])])]),default:n(()=>[s(L,{ref_key:"formRef",ref:l,model:r.value,"label-position":"top",size:"large",rules:h},{default:n(()=>[s(x,{label:"Title",prop:"title"},{default:n(()=>[s(O,{modelValue:r.value.title,"onUpdate:modelValue":f[0]||(f[0]=k=>r.value.title=k),autofocus:""},null,8,["modelValue"])]),_:1}),s(x,{label:"Description",prop:"description"},{default:n(()=>[s(O,{modelValue:r.value.description,"onUpdate:modelValue":f[1]||(f[1]=k=>r.value.description=k),type:"textarea",rows:"6"},null,8,["modelValue"])]),_:1}),s(x,{label:"Due Date",prop:"due_date"},{default:n(()=>[s(P,{modelValue:r.value.due_date,"onUpdate:modelValue":f[2]||(f[2]=k=>r.value.due_date=k),type:"date",placeholder:"Pick a date",class:"!w-full"},null,8,["modelValue"])]),_:1}),s(x,{label:"Status",prop:"status"},{default:n(()=>[s(g,{modelValue:r.value.status,"onUpdate:modelValue":f[3]||(f[3]=k=>r.value.status=k),placeholder:"Select a status"},{default:n(()=>[(v(!0),C(U,null,A(t.allowedStatuses,(k,D)=>(v(),E(M,{key:D,label:k,value:D},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(x,{label:"Priority",prop:"priority"},{default:n(()=>[s(g,{modelValue:r.value.priority,"onUpdate:modelValue":f[4]||(f[4]=k=>r.value.priority=k),placeholder:"Select a priority"},{default:n(()=>[(v(!0),C(U,null,A(t.allowedPriorities,(k,D)=>(v(),E(M,{key:D,label:k,value:D},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}};function re(t,o){return v(),C("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 16.5V9.75m0 0 3 3m-3-3-3 3M6.75 19.5a4.5 4.5 0 0 1-1.41-8.775 5.25 5.25 0 0 1 10.233-2.33 3 3 0 0 1 3.758 3.848A3.752 3.752 0 0 1 18 19.5H6.75Z"})])}function ue(t,o){return v(),C("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 12.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 18.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z"})])}function de(t,o){return v(),C("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})])}function F(t){switch(t){case"in_progress":return"primary";case"completed":return"success";case"cancelled":return"danger";default:return"info"}}function q(t){switch(t){case"medium":return"warning";case"high":return"danger";default:return"info"}}function z(t){return R(t).format("DD-MM-YYYY")}const ce={key:0},pe={class:"mt-3 text-xs text-gray-400"},fe={key:1},me={class:"flex"},_e={__name:"TaskNotes",props:{task:Object},setup(t){const o=t,a=H(()=>o.task.notes),e=N({note:""});function l(){e.note&&e.post(route("tasks.notes.store",o.task),{preserveState:!0,onSuccess:()=>{e.reset()}})}function d(i){confirm("Are you sure you want to delete this note?")&&e.delete(route("tasks.notes.destroy",[o.task,i]))}return(i,r)=>{const u=c("el-icon"),p=c("el-input"),h=c("el-form-item"),V=c("el-button"),y=c("el-form");return v(),C("div",null,[a.value.length?(v(),C("div",ce,[(v(!0),C(U,null,A(a.value,_=>(v(),C("div",{key:_.id,class:"p-2 my-2 rounded border-[1px] relative"},[m("div",null,S(_.note),1),m("div",pe,S(b(R)(_.created_at).format("DD-MM-YYYY HH:ss")),1),s(u,{class:"!absolute top-2 right-2 cursor-pointer",color:"red",size:"16",onClick:f=>d(_)},{default:n(()=>[s(b(de))]),_:2},1032,["onClick"])]))),128))])):(v(),C("div",fe,"No notes created yet")),s(y,{"label-position":"top",class:"mt-6"},{default:n(()=>[s(h,{label:"Add Note"},{default:n(()=>[s(p,{modelValue:b(e).note,"onUpdate:modelValue":r[0]||(r[0]=_=>b(e).note=_),type:"textarea",rows:6},null,8,["modelValue"])]),_:1}),m("div",me,[s(V,{class:"ml-auto",type:"primary",loading:b(e).processing,onClick:Y(l,["prevent"])},{default:n(()=>[w("Add Note")]),_:1},8,["loading"])])]),_:1})])}}};function he(t){return X()?(Q(t),!0):!1}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var Z=ge,K=ke,ve=Object.prototype.toString,j=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function ge(t,o){if(typeof t!="string")throw new TypeError("argument str must be a string");for(var a={},e=o||{},l=e.decode||we,d=0;d<t.length;){var i=t.indexOf("=",d);if(i===-1)break;var r=t.indexOf(";",d);if(r===-1)r=t.length;else if(r<i){d=t.lastIndexOf(";",i-1)+1;continue}var u=t.slice(d,i).trim();if(a[u]===void 0){var p=t.slice(i+1,r).trim();p.charCodeAt(0)===34&&(p=p.slice(1,-1)),a[u]=Ce(p,l)}d=r+1}return a}function ke(t,o,a){var e=a||{},l=e.encode||ye;if(typeof l!="function")throw new TypeError("option encode is invalid");if(!j.test(t))throw new TypeError("argument name is invalid");var d=l(o);if(d&&!j.test(d))throw new TypeError("argument val is invalid");var i=t+"="+d;if(e.maxAge!=null){var r=e.maxAge-0;if(isNaN(r)||!isFinite(r))throw new TypeError("option maxAge is invalid");i+="; Max-Age="+Math.floor(r)}if(e.domain){if(!j.test(e.domain))throw new TypeError("option domain is invalid");i+="; Domain="+e.domain}if(e.path){if(!j.test(e.path))throw new TypeError("option path is invalid");i+="; Path="+e.path}if(e.expires){var u=e.expires;if(!be(u)||isNaN(u.valueOf()))throw new TypeError("option expires is invalid");i+="; Expires="+u.toUTCString()}if(e.httpOnly&&(i+="; HttpOnly"),e.secure&&(i+="; Secure"),e.partitioned&&(i+="; Partitioned"),e.priority){var p=typeof e.priority=="string"?e.priority.toLowerCase():e.priority;switch(p){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(e.sameSite){var h=typeof e.sameSite=="string"?e.sameSite.toLowerCase():e.sameSite;switch(h){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return i}function we(t){return t.indexOf("%")!==-1?decodeURIComponent(t):t}function ye(t){return encodeURIComponent(t)}function be(t){return ve.call(t)==="[object Date]"||t instanceof Date}function Ce(t,o){try{return o(t)}catch{return t}}function Se(){const t=typeof global>"u"?void 0:global.TEST_HAS_DOCUMENT_COOKIE;return typeof t=="boolean"?t:typeof document=="object"&&typeof document.cookie=="string"}function Oe(t){return typeof t=="string"?Z(t):typeof t=="object"&&t!==null?t:{}}function $(t,o={}){const a=Te(t);if(!o.doNotParse)try{return JSON.parse(a)}catch{}return t}function Te(t){return t&&t[0]==="j"&&t[1]===":"?t.substr(2):t}class xe{constructor(o,a={}){this.changeListeners=[],this.HAS_DOCUMENT_COOKIE=!1,this.update=()=>{if(!this.HAS_DOCUMENT_COOKIE)return;const l=this.cookies;this.cookies=Z(document.cookie),this._checkChanges(l)};const e=typeof document>"u"?"":document.cookie;this.cookies=Oe(o||e),this.defaultSetOptions=a,this.HAS_DOCUMENT_COOKIE=Se()}_emitChange(o){for(let a=0;a<this.changeListeners.length;++a)this.changeListeners[a](o)}_checkChanges(o){new Set(Object.keys(o).concat(Object.keys(this.cookies))).forEach(e=>{o[e]!==this.cookies[e]&&this._emitChange({name:e,value:$(this.cookies[e])})})}_startPolling(){this.pollingInterval=setInterval(this.update,300)}_stopPolling(){this.pollingInterval&&clearInterval(this.pollingInterval)}get(o,a={}){return a.doNotUpdate||this.update(),$(this.cookies[o],a)}getAll(o={}){o.doNotUpdate||this.update();const a={};for(let e in this.cookies)a[e]=$(this.cookies[e],o);return a}set(o,a,e){e?e=Object.assign(Object.assign({},this.defaultSetOptions),e):e=this.defaultSetOptions;const l=typeof a=="string"?a:JSON.stringify(a);this.cookies=Object.assign(Object.assign({},this.cookies),{[o]:l}),this.HAS_DOCUMENT_COOKIE&&(document.cookie=K(o,l,e)),this._emitChange({name:o,value:a,options:e})}remove(o,a){const e=a=Object.assign(Object.assign(Object.assign({},this.defaultSetOptions),a),{expires:new Date(1970,1,1,0,0,1),maxAge:0});this.cookies=Object.assign({},this.cookies),delete this.cookies[o],this.HAS_DOCUMENT_COOKIE&&(document.cookie=K(o,"",e)),this._emitChange({name:o,value:void 0,options:a})}addChangeListener(o){this.changeListeners.push(o),this.HAS_DOCUMENT_COOKIE&&this.changeListeners.length===1&&(typeof window=="object"&&"cookieStore"in window?window.cookieStore.addEventListener("change",this.update):this._startPolling())}removeChangeListener(o){const a=this.changeListeners.indexOf(o);a>=0&&this.changeListeners.splice(a,1),this.HAS_DOCUMENT_COOKIE&&this.changeListeners.length===0&&(typeof window=="object"&&"cookieStore"in window?window.cookieStore.removeEventListener("change",this.update):this._stopPolling())}}function Ve(t,{doNotParse:o=!1,autoUpdateDependencies:a=!1}={},e=new xe){const l=a?[...t||[]]:t;let d=e.getAll({doNotParse:!0});const i=T(0),r=()=>{const u=e.getAll({doNotParse:!0});Ee(l||null,u,d)&&i.value++,d=u};return e.addChangeListener(r),he(()=>{e.removeChangeListener(r)}),{get:(...u)=>(a&&l&&!l.includes(u[0])&&l.push(u[0]),i.value,e.get(u[0],{doNotParse:o,...u[1]})),getAll:(...u)=>(i.value,e.getAll({doNotParse:o,...u[0]})),set:(...u)=>e.set(...u),remove:(...u)=>e.remove(...u),addChangeListener:(...u)=>e.addChangeListener(...u),removeChangeListener:(...u)=>e.removeChangeListener(...u)}}function Ee(t,o,a){if(!t)return!0;for(const e of t)if(o[e]!==a[e])return!0;return!1}const De=m("div",{class:"font-medium"},[w(" Drop file here or "),m("em",{class:"text-accent"},"Click to upload")],-1),Me={__name:"TaskAttachments",props:{task:Object},setup(t){const o=t,a=Ve(),e=H(()=>a.get("XSRF-TOKEN"));function l(i){window.open(i.url??i.response.url,"_blank")}function d(i){B.delete(route("tasks.media.delete",{task:o.task,media:i.id??i.response.id}),{preserveState:!0})}return(i,r)=>{const u=c("el-icon"),p=c("el-upload");return v(),E(p,{drag:"",action:i.route("tasks.media.store",t.task),multiple:"",headers:{"X-XSRF-TOKEN":e.value},"file-list":t.task.media,"on-preview":l,"on-remove":d},{default:n(()=>[s(u,{size:"48"},{default:n(()=>[s(b(re))]),_:1}),De]),_:1},8,["action","headers","file-list"])}}},je={class:"p-4 pt-0"},Ne={class:"flex items-center"},Pe={class:"bold text-2xl text-black"},Le={class:"flex items-center mt-4"},$e={class:"flex"},Ue=m("hr",{class:"my-6"},null,-1),Ae={class:"whitespace-pre-line"},He=m("hr",{class:"my-6"},null,-1),Ie={__name:"TaskViewModal",props:I({allowedStatuses:Object,allowedPriorities:Object},{modelValue:{type:Object},modelModifiers:{}}),emits:I(["editTask"],["update:modelValue"]),setup(t,{expose:o,emit:a}){const e=T(!1),l=W(t,"modelValue"),d=a;o({openModal:i});function i(){e.value=!0}function r(){e.value=!1,d("editTask",l.value)}return(u,p)=>{const h=c("el-tag"),V=c("el-link"),y=c("el-tab-pane"),_=c("el-tabs"),f=c("el-dialog");return v(),E(f,{modelValue:e.value,"onUpdate:modelValue":p[0]||(p[0]=O=>e.value=O),width:"50%"},{default:n(()=>[m("div",je,[m("div",Ne,[m("div",Pe," title"+S(l.value.title),1),s(h,{type:b(F)(l.value.status),class:"ml-4"},{default:n(()=>[w(S(t.allowedStatuses[l.value.status]),1)]),_:1},8,["type"])]),m("div",Le,[s(h,{type:b(q)(l.value.priority)},{default:n(()=>[w(S(t.allowedPriorities[l.value.priority]),1)]),_:1},8,["type"]),s(h,{class:"ml-3"},{default:n(()=>[w("Due: "+S(b(z)(l.value.due_date)),1)]),_:1})]),m("div",$e,[s(V,{class:"ml-auto !text-accent",onClick:r},{default:n(()=>[w("Edit Task ")]),_:1})]),Ue,m("div",Ae,S(l.value.description),1),He,s(_,null,{default:n(()=>[s(y,{label:"Notes"},{default:n(()=>[s(_e,{task:l.value},null,8,["task"])]),_:1}),s(y,{label:"Attachments"},{default:n(()=>[s(Me,{task:l.value},null,8,["task"])]),_:1})]),_:1})])]),_:1},8,["modelValue"])}}},Ke=m("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Task Manager ",-1),Re={class:"py-6"},Ye={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Be={class:"mb-5"},Fe={class:"bg-white overflow-hidden shadow-xl p-8 font-bold text-xl"},Je={__name:"Tasks",props:{tasks:Object,allowedStatuses:Object,allowedPriorities:Object},setup(t){const o=t,a=T(null),e=T(null),l=T(null);H(()=>te().props.auth.user);function d(p){a.value.editTask(p)}function i(p){confirm("Are you sure you want to delete this task?")&&B.delete(route("tasks.destroy",p.id))}function r(p){l.value=p,e.value.openModal()}function u(p){r(o.tasks.data.find(h=>h.id===parseInt(p)))}return ee(()=>o.tasks,()=>{l.value&&(l.value=o.tasks.data.find(p=>p.id===l.value.id))}),(p,h)=>{const V=c("el-button"),y=c("el-table-column"),_=c("el-tag"),f=c("el-icon"),O=c("el-dropdown-item"),x=c("el-dropdown-menu"),P=c("el-dropdown"),M=c("el-table");return v(),E(oe,{title:"Tasks"},{header:n(()=>[Ke]),default:n(()=>[m("div",Re,[m("div",Ye,[m("div",Be,[s(V,{type:"primary",onClick:h[0]||(h[0]=g=>p.$refs.formModal.createTask())},{default:n(()=>[w("Create Task")]),_:1})]),m("div",Fe,[s(M,{data:t.tasks.data,"default-sort":{prop:"due_date",order:"descending"},style:{width:"100%"},class:"clickable",onRowClick:r},{default:n(()=>[s(y,{prop:"title",label:"Title",sortable:""}),s(y,{prop:"due_date",label:"Due Date",sortable:""},{default:n(g=>[w(S(b(z)(g.row.due_date)),1)]),_:1}),s(y,{prop:"status",label:"Status",sortable:""},{default:n(g=>[s(_,{type:b(F)(g.row.status)},{default:n(()=>[w(S(t.allowedStatuses[g.row.status]),1)]),_:2},1032,["type"])]),_:1}),s(y,{prop:"priority",label:"Priority",sortable:""},{default:n(g=>[s(_,{type:b(q)(g.row.priority)},{default:n(()=>[w(S(t.allowedPriorities[g.row.priority]),1)]),_:2},1032,["type"])]),_:1}),s(y,{label:""},{default:n(g=>[s(P,null,{dropdown:n(()=>[s(x,null,{default:n(()=>[s(O,{onClick:L=>d(g.row)},{default:n(()=>[w("Edit")]),_:2},1032,["onClick"]),s(O,{class:"!text-red-500",onClick:L=>i(g.row)},{default:n(()=>[w("Delete ")]),_:2},1032,["onClick"])]),_:2},1024)]),default:n(()=>[s(f,{size:"32",onClick:h[1]||(h[1]=Y(()=>{},["prevent","stop"]))},{default:n(()=>[s(b(ue))]),_:1})]),_:2},1024)]),_:1})]),_:1},8,["data"])])])]),s(le,{ref_key:"formModal",ref:a,"allowed-priorities":t.allowedPriorities,"allowed-statuses":t.allowedStatuses,onTaskCreated:u},null,8,["allowed-priorities","allowed-statuses"]),s(Ie,{ref_key:"viewModal",ref:e,modelValue:l.value,"onUpdate:modelValue":h[2]||(h[2]=g=>l.value=g),"allowed-statuses":t.allowedStatuses,"allowed-priorities":t.allowedPriorities,onEditTask:d},null,8,["modelValue","allowed-statuses","allowed-priorities"])]),_:1})}}};export{Je as default};
